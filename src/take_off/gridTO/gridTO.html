<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="../styles.css">
  <style>
    /* Additional styles can be added here if needed */
  </style>
  <title>Table OCR → Grid → XLSX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Tesseract.js -->
<script src="https://unpkg.com/tesseract.js@5.1.0/dist/tesseract.min.js"></script>
<!-- OpenCV.js -->
<script async src="https://docs.opencv.org/4.x/opencv.js"></script>
<!-- SheetJS (official CDN with correct MIME) -->
<script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js" id="xlsx-script"></script>
</head>
<body data-page="take-off-gridto">
<div class="wrap">
  <h1>Table OCR → Grid → XLSX (offline)</h1>
  <div class="card">
    <div class="row">
      <span class="pill">Paste (Ctrl/Cmd-V) or use “Paste from Clipboard”</span>
      <span class="pill">Set Target rows/cols, drag grid nodes to align, then click “Extract Table”.</span>
    </div>

    <div id="drop" class="drop" tabindex="0">
      <div>
        <div style="font-weight:700;color:#e2e8f0">Drop an image here or click to select</div>
        <div class="small">Or click “Paste from Clipboard” (HTTPS/permission required)</div>
        <div style="height:8px"></div>
        <button id="chooseBtn">Choose Image</button>
        <button id="pasteBtn" class="secondary">Paste from Clipboard</button>
        <input id="file" type="file" accept="image/*" />
      </div>
    </div>

    <div class="row" style="margin-top:10px">
      <div id="canvasWrap" class="canvas-wrap" style="width:100%">
        <canvas id="preview" style="display:none"></canvas>
        <canvas id="overlay" style="display:none"></canvas>
      </div>
    </div>

    <hr style="border-color:#1f2937;margin:14px 0">

    <div class="kv">
      <div><label>Target rows</label>
        <input type="number" id="targetRows" min="0" value="0">
      </div>
      <div><label>Target columns</label>
        <input type="number" id="targetCols" min="0" value="0">
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <button id="extractBtn" disabled>Extract Table</button>
      <button id="xlsxBtn" disabled>Download .xlsx</button>
      <span id="status" class="small"></span>
    </div>

    <div class="row small">
      <span>Angle: <code id="angle">–</code></span>
      <span>Grid: <code id="grid">–</code></span>
      <span>Cells: <code id="cells">–</code></span>
      <span>SheetJS: <code id="sj">checking…</code></span>
    </div>

    <div class="row"><div style="width:100%;overflow:auto"><table id="tbl"></table></div></div>
  </div>
</div>

<script src="gridTO.js"></script>
</body>
</html>
